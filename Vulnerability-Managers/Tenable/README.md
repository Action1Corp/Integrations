# Action1 -- Vulnerability Manager CSV Reporting

## Overview

The **Action1 -- Vulnerability Manager CSV Reporting** script automates the correlation of
vulnerability data between a Vulnerability Manager CSV export and Action1,
allowing IT and security teams to:

-   Correlate detected vulnerabilities from the Vulnerability Manager
-   Match vulnerabilities to Action1-managed endpoints
-   Detect "unknown" or "missing" assets from each platform
-   Generate reports for compliance and tracking

This guide explains what the integration does, how to set up API
credentials for Action1, and how to run the PowerShell
script.
It is recommended to run the script on the same frequency as the
vulnerability scanner.

## What the Integration Does

The PowerShell script:

-   Reads as input a CSV file containing vulnerability data
-   Connects to Action1 Cloud Console to pull vulnerability data
-   Compares vulnerability data to identify:
    -   Patchable vulnerabilities
    -   Non-patchable vulnerabilities
    -   CVEs not recognized by Action1
    -   Missing assets from Action1
    -   Missing assets from the Vulnerability Manager
-   **Optional:** Emails generated reports

## Prerequisites

Before running the integration:

-   PowerShell **5.1 or later** (Windows 10/11, Server 2016+)
-   Network access to:
    -   `https://app.action1.com`
-   API credentials for Action1

## Getting Action1 API Credentials

1.  Log in to Action1: https://app.action1.com
2.  Go to **Users & API Credentials**
3.  Click **New API Credentials**
4.  Save:
    -   Client ID
    -   Client Secret
    -   Organization ID

Use these in the script:

    $Action1ApiKey = "<your_client_id>"
    $Action1ApiSecret = "<your_client_secret>"
    $Action1OrgId = "<your_organization_id>"

## Running the Integration Script

Update the parameters before running the script.

### Parameters

  Parameter          Description
  ------------------ -----------------------
  InputCSV           File path to input CSV
  CSVHostHeader      The column header within the CSV containing the endpoint names
  CSVCVEHeader       The column header within the CSV containing the CVE IDs
  Action1APIKey      Action1 API key
  Action1APISecret   Secret key
  Action1OrgID       Organization ID
  Action1Region      Regional environment
  OutputDirectory    Directory for reports
  SendEmail          Enable email
  SmtpServer         SMTP server
  SmtpPort           SMTP port
  SmtpUser           SMTP username
  SmtpPassword       SMTP password
  MailFrom           Sender email
  MailTo             Recipient(s)
  MailSubject        Email subject
  UseSsl             Use SSL/TLS

## Output

Generated files:

-   Action1_Endpoints_Not_In_CSV.csv
-   CSV_Hosts_Not_In_Action1.csv
-   CSV_CVEs_for_Remediation.csv
-   CSV_CVEs_Not_Recognized_by_Action1.csv
-   CSV_CVEs_with_No_Patch_Available.csv
